(function(t,e,r,i){"use strict";var o=i,s=e.Router.prototype.route;r.extend(e.Router.prototype,{_setPromisedTitle:function(e,r){var s=this;if(!i)throw Error("Backbonejs-Router-Title-Helper: Currently only jQuery.Deferred object is supported");if(!i.Deferred)throw Error("Backbonejs-Router-Title-Helper: jQuery >= 1.5 is required to use Deferred object");o.when(e).then(function(e){t.title=e,s.trigger("change:title",r,e),delete s.titles[r],s.titles[r]=new i.Deferred},function(){throw Error("Backbonejs-Router-Title-Helper: Your deferred job failed. No title to set.")})},_setTitle:function(e){var r=this.titles[e];if(!r&&!this.titles["default"])throw Error("Backbonejs-Router-Title-Helper: No title found and no default title provided.");return"object"==typeof r&&r.promise?this._setPromisedTitle(r,e):(t.title="function"==typeof r?r.apply(this,arguments):this[r]?this[r].apply(this,arguments):"string"==typeof r?r:"function"==typeof this.titles["default"]?this.titles["default"].apply(this,arguments):this.titles["default"],this.trigger("change:title",e,t.title),void 0)},route:function(t,e,r){var i=function(){r||(r=this[e]),r.apply(this,arguments),this.titles&&this._setTitle(e)};return s.call(this,t,e,i)}})})(document,Backbone,_,jQuery);