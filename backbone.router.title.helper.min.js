(function(e){"use strict";"function"==typeof define&&define.amd?define(["underscore","backbone"],e):e(_,Backbone)})(function(e,t){"use strict";var i=t.Router.prototype.route;e.extend(t.Router.prototype,{_setPromisedTitle:function(e,t){var i=this;if(!jQuery)throw Error("Backbonejs-Router-Title-Helper: Currently only jQuery.Deferred object is supported");if(!jQuery.Deferred)throw Error("Backbonejs-Router-Title-Helper: jQuery >= 1.5 is required to use Deferred object");$.when(e).then(function(e){document.title=e,i.trigger("change:title",t,e),delete i.titles[t],i.titles[t]=new jQuery.Deferred},function(){throw Error("Backbonejs-Router-Title-Helper: Your deferred job failed. No title to set.")})},_setTitle:function(t){var i,r=this.titles[t];if(e.isUndefined(r)&&e.isUndefined(this.titles["default"]))throw Error("Backbonejs-Router-Title-Helper: No title found and no default title provided.");return e.has(r,"promise")?this._setPromisedTitle(r,t):(i=e.isFunction(r)?r.apply(this,arguments):this[r]?this[r].apply(this,arguments):e.isString(r)?r:e.isFunction(this.titles["default"])?this.titles["default"].apply(this,arguments):this.titles["default"],document.title=i,this.trigger("change:title",t,i),void 0)},route:function(e,t,r){var o=function(){r||(r=this[t]),r.apply(this,arguments),this.titles&&this._setTitle(t)};return i.call(this,e,t,o)}})});