(function(e,t){var r=e.Router.prototype.route;t.extend(e.Router.prototype,{_setPromisedTitle:function(e,t){var r=this;if(!jQuery)throw Error("Backbonejs-Router-Title-Helper: Currently only jQuery.Deferred object is supported");if(!jQuery.Deferred)throw Error("Backbonejs-Router-Title-Helper: jQuery >= 1.5 is required to use Deferred object");$.when(e).then(function(e){document.title=e,r.trigger("change:title",t,e),delete r.titles[t],r.titles[t]=new jQuery.Deferred},function(){throw Error("Backbonejs-Router-Title-Helper: Your deferred job failed. No title to set.")})},_setTitle:function(e){var t=this.titles[e];if(!t&&!this.titles.default)throw Error("Backbonejs-Router-Title-Helper: No title found and no default title provided.");return"object"==typeof t&&t.promise?this._setPromisedTitle(t,e):(document.title="function"==typeof t?t.apply(this,arguments):this[t]?this[t].apply(this,arguments):"string"==typeof t?t:this.titles.default,this.trigger("change:title",e,document.title),void 0)},route:function(e,t,i){var o=function(){i||(i=this[t]),i.apply(this,arguments),this.titles&&this._setTitle(t)};return r.call(this,e,t,o)}})})(Backbone,_);